# Maintainer: Eric BURGHARD <eric@itsufficient.me>
pkgname=reposerve
pkgver=0.7.0
pkgrel=0
pkgdesc="Simple alpine packages server for consuming and updating packages in CI/CD"
url="https://git.itsufficient.me/rust/reposerve"
arch="x86_64"
license="ASL 2.0"
makedepends="cargo clang-dev llvm-dev"
depends="abuild"
source="$pkgname-$pkgver.tar.gz::https://github.com/eburghar/reposerve/archive/refs/tags/$pkgver.tar.gz"

build() {
  cargo build --release
}

check() {
  cargo test all --release
}

package() {
  install -Dm755 target/release/"$pkgname"   "$pkgdir"/usr/bin/"$pkgname"
  install -Dm644 "$srcdir/reposerve.yaml" -t "$pkgdir/etc/"
	install -Dm755 "$srcdir/$pkgname.initd" 	 "$pkgdir/etc/init.d/$pkgname"

}

sha512sums="
d20c5fb5d9f769add480e4897f63565d8240005df9e7fa316a22a380c2eeac258e41476ec6936d0af4ea51e6f0639316448ba06c586ab08b3c321601fe3abb87  reposerve-0.5.0.tar.gz
"
