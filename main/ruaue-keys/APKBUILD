# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=ruaue-keys
pkgver=1
pkgrel=0
pkgdesc="Public keys for repo.vyos.eu.org packages"
url="https://repo.vyos.eu.org"
# we install arch specific keys to /etc so we cannot do arch=noarch
arch="all"
license="BSD-3-Clause"
options="!check"

_arch_keys="x86_64:apk@ruaue.com-65a20657.rsa.pub"

for _i in $_arch_keys; do
	source="$source ${_i#*:}"
done

_ins_key() {
	msg "- $2 ($1)"
	install -Dm644 "$srcdir"/$2 "$pkgdir"/etc/apk/keys/$2
}

_install_x86() {
	case "$1" in
	x86*) _ins_key $1 $2 ;;
	esac
}

package() {
	# copy keys for repos
	mkdir -p "$pkgdir"/etc/apk/keys
	for i in $_arch_keys; do
		_archs="${i%:*}"
		_key="${i#*:}"
		install -Dm644 "$srcdir"/$_key \
			"$pkgdir"/usr/share/apk/keys/$_key

		for _arch in ${_archs//,/ }; do
			mkdir -p "$pkgdir"/usr/share/apk/keys/$_arch
			ln -s ../$_key "$pkgdir"/usr/share/apk/keys/$_arch/

			case "$CARCH" in
			x86*) _install_x86 $_arch $_key ;;
			esac
		done
	done
}

sha512sums="
c36281116bad0c8c0c5e24b09366e9a238d68d7ead69167da8601e05951f895a007838e45d003aac1e5c10c3db52be6f4e2dc1d583f5eab3912ac26a8423819a  apk@ruaue.com-65a20657.rsa.pub
"
  48 
  49 sha512sums="
  50 c36281116bad0c8c0c5e24b09366e9a238d68d7ead69167da8601e05951f895a007838e45d003aac1e5c10c3db52be6f4e2dc1d583f5eab3912ac26a8423819a  apk@ruaue.com-65a20657.rsa.pub
